FROM python:3
ENV PYTHONUNBUFFERED 1

ARG SECRET_KEY

ARG POSTGRES_TABLE_NAME 
ARG POSTGRES_USER 
ARG POSTGRES_PASSWORD 
ARG POSTGRES_HOST 
ARG POSTGRES_PORT

ARG DEBUG
ARG HTTPS

ARG EMAIL_HOST
ARG EMAIL_PORT
ARG EMAIL_HOST_USER
ARG EMAIL_HOST_PASSWORD

ARG CELERY_BROKER_URL
ARG SELENIUM_REMOTE_URL

ENV SECRET_KEY $SECRET_KEY

ENV POSTGRES_TABLE_NAME $POSTGRES_TABLE_NAME
ENV POSTGRES_USER $POSTGRES_USER
ENV POSTGRES_PASSWORD $POSTGRES_PASSWORD
ENV POSTGRES_HOST $POSTGRES_HOST 
ENV POSTGRES_PORT $POSTGRES_PORT

ENV DEBUG $DEBUG
ENV HTTPS $HTTPS

ENV EMAIL_HOST $EMAIL_HOST
ENV EMAIL_PORT $EMAIL_PORT
ENV EMAIL_HOST_USER $EMAIL_HOST_USER
ENV EMAIL_HOST_PASSWORD $EMAIL_HOST_PASSWORD

ENV CELERY_BROKER_URL $CELERY_BROKER_URL

ENV SELENIUM_REMOTE_URL $SELENIUM_REMOTE_URL

WORKDIR /django
COPY requirements.txt requirements.txt

RUN pip3 install -r requirements.txt
ENTRYPOINT ["./entrypoint.sh"]

COPY . .